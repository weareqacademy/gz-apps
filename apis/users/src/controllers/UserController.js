'use strict';const _0x3caa70=_0x3b07;function _0x3b07(_0x136ad2,_0x16d3ab){const _0x4255f0=_0x4255();return _0x3b07=function(_0x3b074a,_0x5e3721){_0x3b074a=_0x3b074a-0x11a;let _0x113fa7=_0x4255f0[_0x3b074a];return _0x113fa7;},_0x3b07(_0x136ad2,_0x16d3ab);}(function(_0x1dace8,_0x5e486e){const _0x5a20bc=_0x3b07,_0x4181fa=_0x1dace8();while(!![]){try{const _0x2adc02=-parseInt(_0x5a20bc(0x138))/0x1+parseInt(_0x5a20bc(0x145))/0x2+parseInt(_0x5a20bc(0x146))/0x3+-parseInt(_0x5a20bc(0x11e))/0x4*(parseInt(_0x5a20bc(0x141))/0x5)+parseInt(_0x5a20bc(0x13e))/0x6*(parseInt(_0x5a20bc(0x131))/0x7)+-parseInt(_0x5a20bc(0x120))/0x8*(-parseInt(_0x5a20bc(0x139))/0x9)+-parseInt(_0x5a20bc(0x121))/0xa;if(_0x2adc02===_0x5e486e)break;else _0x4181fa['push'](_0x4181fa['shift']());}catch(_0x4fcb1f){_0x4181fa['push'](_0x4181fa['shift']());}}}(_0x4255,0xac7ab));function _0x4255(){const _0x34fceb=['body','log','Incorrect\x20email','del','220AtWWRz','show','8009464prbFOm','22007070sntYTR','default','test','update','geeks.user_id','where','send','end','email','select','hash','../database/connection','defineProperty','json','users.*','rollback','77RteNMp','Required\x20name','Unexpected\x20error\x20while\x20removing\x20user\x20data','user_id','commit','__importDefault','transaction','65389tZXCbC','9yLTlFH','length','join','status','users.id','154698BJwWne','insert','geeks','4325nyyVaO','User\x20doesn\x27t\x20exists','users','__esModule','1406920didxHU','3095670wpdQUq','Required\x20email','returning'];_0x4255=function(){return _0x34fceb;};return _0x4255();}var __importDefault=this&&this[_0x3caa70(0x136)]||function(_0x7c4bc0){const _0x599927=_0x3caa70;return _0x7c4bc0&&_0x7c4bc0[_0x599927(0x144)]?_0x7c4bc0:{'default':_0x7c4bc0};};Object[_0x3caa70(0x12d)](exports,'__esModule',{'value':!![]});const connection_1=__importDefault(require(_0x3caa70(0x12c))),bcrypt_1=__importDefault(require('bcrypt'));class UserController{async['store'](_0x18370f,_0x249fc6){const _0x32c1f4=_0x3caa70,{name:_0x58204b,email:_0x193018,password:_0x21672b}=_0x18370f['body'];if(!_0x58204b||_0x58204b[_0x32c1f4(0x13a)]<=0x0)return _0x249fc6[_0x32c1f4(0x13c)](0x190)['json']({'error':_0x32c1f4(0x132)});const _0x5d0619=/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;if(!_0x193018||_0x193018[_0x32c1f4(0x13a)]<=0x0)return _0x249fc6[_0x32c1f4(0x13c)](0x190)['json']({'error':_0x32c1f4(0x147)});else{if(!_0x5d0619[_0x32c1f4(0x123)](_0x193018))return _0x249fc6[_0x32c1f4(0x13c)](0x190)[_0x32c1f4(0x12e)]({'error':_0x32c1f4(0x11c)});}if(!_0x21672b||_0x21672b['length']<=0x0)return _0x249fc6[_0x32c1f4(0x13c)](0x190)[_0x32c1f4(0x12e)]({'error':'Required\x20pass'});const _0x2cf5ec=await connection_1['default']('users')[_0x32c1f4(0x126)](_0x32c1f4(0x129),_0x193018);if(_0x2cf5ec[_0x32c1f4(0x13a)]!==0x0)return _0x249fc6[_0x32c1f4(0x13c)](0x190)[_0x32c1f4(0x12e)]({'error':'User\x20already\x20exists'});const _0x27b2ee=await bcrypt_1[_0x32c1f4(0x122)][_0x32c1f4(0x12b)](_0x21672b,0x8),_0x2ae61d=await connection_1['default'][_0x32c1f4(0x137)]();try{const [_0x3fad05]=await _0x2ae61d('users')[_0x32c1f4(0x13f)]({'name':_0x58204b,'email':_0x193018,'password_hash':_0x27b2ee})[_0x32c1f4(0x148)](['id']);return await _0x2ae61d[_0x32c1f4(0x135)](),_0x249fc6[_0x32c1f4(0x13c)](0xc9)[_0x32c1f4(0x12e)](_0x3fad05);}catch(_0x5103b2){return console['log'](_0x5103b2),await _0x2ae61d[_0x32c1f4(0x130)](),_0x249fc6[_0x32c1f4(0x13c)](0x190)['json']({'error':'Unexpected\x20error\x20while\x20creating\x20new\x20user'});}}async[_0x3caa70(0x124)](_0x119105,_0x416f9c){const _0x4fc539=_0x3caa70,{name:_0x3af95b,email:_0x38f2e7,whatsapp:_0x26c33c,avatar:_0x1b7033,is_geek:_0x30ffeb}=_0x119105[_0x4fc539(0x11a)],_0x5a74f6=_0x119105['id'];if(!_0x3af95b||_0x3af95b[_0x4fc539(0x13a)]<=0x0)return _0x416f9c[_0x4fc539(0x13c)](0x190)[_0x4fc539(0x12e)]({'error':_0x4fc539(0x132)});const _0x437114=/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;if(!_0x38f2e7||_0x38f2e7[_0x4fc539(0x13a)]<=0x0)return _0x416f9c[_0x4fc539(0x13c)](0x190)[_0x4fc539(0x12e)]({'error':'Required\x20email'});else{if(!_0x437114[_0x4fc539(0x123)](_0x38f2e7))return _0x416f9c['status'](0x190)[_0x4fc539(0x12e)]({'error':'Incorrect\x20email'});}const _0x502580=await connection_1[_0x4fc539(0x122)](_0x4fc539(0x143))[_0x4fc539(0x126)]('id',_0x5a74f6);if(_0x502580[_0x4fc539(0x13a)]===0x0)return _0x416f9c[_0x4fc539(0x13c)](0x190)[_0x4fc539(0x12e)]({'error':_0x4fc539(0x142)});const _0x4576c9=await connection_1[_0x4fc539(0x122)][_0x4fc539(0x137)]();try{if(!_0x3af95b&&!_0x38f2e7&&_0x26c33c[_0x4fc539(0x13a)]>0x0&&!_0x1b7033)await _0x4576c9('users')[_0x4fc539(0x126)]('id',_0x5a74f6)[_0x4fc539(0x124)]({'whatsapp':_0x26c33c});else{const _0x29611b=_0x119105[_0x4fc539(0x11a)];await _0x4576c9(_0x4fc539(0x143))['where']('id',_0x5a74f6)['update'](_0x29611b);}return await _0x4576c9[_0x4fc539(0x135)](),_0x416f9c['status'](0xc8)[_0x4fc539(0x127)]();}catch(_0x21a68f){return console['log'](_0x21a68f),await _0x4576c9[_0x4fc539(0x130)](),_0x416f9c[_0x4fc539(0x13c)](0x190)[_0x4fc539(0x12e)]({'error':'Unexpected\x20error\x20while\x20updating\x20user'});}}async[_0x3caa70(0x11f)](_0x26080e,_0x279862){const _0x4ef261=_0x3caa70,_0x5d04a3=_0x26080e['id'];let _0x2e7053=await connection_1[_0x4ef261(0x122)](_0x4ef261(0x143))[_0x4ef261(0x126)](_0x4ef261(0x13d),_0x5d04a3)[_0x4ef261(0x12a)]([_0x4ef261(0x12f)]);if(_0x2e7053[_0x4ef261(0x13a)]===0x0)return _0x279862['status'](0x194)[_0x4ef261(0x128)]();const _0x5668f8=await connection_1['default'](_0x4ef261(0x140))[_0x4ef261(0x126)](_0x4ef261(0x134),_0x5d04a3);let _0x5d4bd3=_0x2e7053[0x0];return _0x5668f8[_0x4ef261(0x13a)]>0x0&&(_0x2e7053=await connection_1['default']('users')[_0x4ef261(0x126)](_0x4ef261(0x13d),_0x5d04a3)[_0x4ef261(0x13b)](_0x4ef261(0x140),_0x4ef261(0x125),_0x4ef261(0x13d)),_0x5d4bd3=_0x2e7053[0x0]),_0x279862['json'](_0x5d4bd3);}async['remove'](_0x135f70,_0x56fc67){const _0x3005f0=_0x3caa70,_0x3c10ec=_0x135f70['id'],_0x536b90=await connection_1[_0x3005f0(0x122)][_0x3005f0(0x137)]();try{let _0x5be0d8=await connection_1[_0x3005f0(0x122)](_0x3005f0(0x143))[_0x3005f0(0x126)](_0x3005f0(0x13d),_0x3c10ec)[_0x3005f0(0x12a)]([_0x3005f0(0x12f)]);if(_0x5be0d8[_0x3005f0(0x13a)]===0x0)return _0x56fc67[_0x3005f0(0x13c)](0xcc)[_0x3005f0(0x128)]();let _0x45fb3f=_0x5be0d8[0x0];return await _0x536b90(_0x3005f0(0x140))[_0x3005f0(0x126)](_0x3005f0(0x134),_0x45fb3f['id'])[_0x3005f0(0x11d)](),await _0x536b90(_0x3005f0(0x143))[_0x3005f0(0x126)]('id',_0x45fb3f['id'])[_0x3005f0(0x11d)](),await _0x536b90[_0x3005f0(0x135)](),_0x56fc67[_0x3005f0(0x13c)](0xcc)[_0x3005f0(0x128)]();}catch(_0x8bf072){return console[_0x3005f0(0x11b)](_0x8bf072),await _0x536b90[_0x3005f0(0x130)](),_0x56fc67[_0x3005f0(0x13c)](0x190)[_0x3005f0(0x12e)]({'error':_0x3005f0(0x133)});}}}exports[_0x3caa70(0x122)]=UserController;