'use strict';const _0x1ab706=_0x53b1;function _0x53b1(_0xb62c6,_0x4ad7a7){const _0x4a67cc=_0x4a67();return _0x53b1=function(_0x53b1f8,_0x58c440){_0x53b1f8=_0x53b1f8-0x154;let _0x2724cd=_0x4a67cc[_0x53b1f8];return _0x2724cd;},_0x53b1(_0xb62c6,_0x4ad7a7);}(function(_0x66ca95,_0x5311f9){const _0x2f66de=_0x53b1,_0x21112f=_0x66ca95();while(!![]){try{const _0x57d341=parseInt(_0x2f66de(0x16d))/0x1+parseInt(_0x2f66de(0x16a))/0x2+-parseInt(_0x2f66de(0x161))/0x3+-parseInt(_0x2f66de(0x168))/0x4+parseInt(_0x2f66de(0x16c))/0x5+-parseInt(_0x2f66de(0x156))/0x6+parseInt(_0x2f66de(0x15f))/0x7*(parseInt(_0x2f66de(0x16b))/0x8);if(_0x57d341===_0x5311f9)break;else _0x21112f['push'](_0x21112f['shift']());}catch(_0x3d78cb){_0x21112f['push'](_0x21112f['shift']());}}}(_0x4a67,0xa630f));var __importDefault=this&&this[_0x1ab706(0x15a)]||function(_0x4412e1){const _0x5d8ca0=_0x1ab706;return _0x4412e1&&_0x4412e1[_0x5d8ca0(0x165)]?_0x4412e1:{'default':_0x4412e1};};function _0x4a67(){const _0x1a0602=['defineProperty','secret','__esModule','where','body','1816752BTqvbT','bcrypt','234658bzwCli','8OOVclC','4745365IxKwKi','871141VFaulh','../config/auth','compare','status','test','../database/connection','jsonwebtoken','length','3696096DUHsjV','sign','json','users.*','__importDefault','Incorrect\x20email','email','expiresIn','password_hash','4037656uxZZhi','store','2290284qJpDHf','default'];_0x4a67=function(){return _0x1a0602;};return _0x4a67();}Object[_0x1ab706(0x163)](exports,'__esModule',{'value':!![]});const connection_1=__importDefault(require(_0x1ab706(0x172))),bcrypt_1=__importDefault(require(_0x1ab706(0x169))),jsonwebtoken_1=__importDefault(require(_0x1ab706(0x154))),auth_1=__importDefault(require(_0x1ab706(0x16e)));class SessionController{async[_0x1ab706(0x160)](_0x5082c5,_0x119d5c){const _0x439e99=_0x1ab706,{email:_0x387c94,password:_0x25359a}=_0x5082c5[_0x439e99(0x167)],_0x38c351=/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;if(!_0x387c94||_0x387c94['length']<=0x0)return _0x119d5c['status'](0x190)['json']({'error':'Required\x20email'});else{if(!_0x38c351[_0x439e99(0x171)](_0x387c94))return _0x119d5c[_0x439e99(0x170)](0x190)[_0x439e99(0x158)]({'error':_0x439e99(0x15b)});}if(!_0x25359a||_0x25359a[_0x439e99(0x155)]<=0x0)return _0x119d5c[_0x439e99(0x170)](0x190)['json']({'error':'Required\x20pass'});const _0x2b088c=await connection_1['default']('users')[_0x439e99(0x166)](_0x439e99(0x15c),'=',_0x387c94)['select']([_0x439e99(0x159)]);if(_0x2b088c[_0x439e99(0x155)]===0x0)return _0x119d5c[_0x439e99(0x170)](0x191)[_0x439e99(0x158)]({'error':'Unauthorized'});if(!await bcrypt_1[_0x439e99(0x162)][_0x439e99(0x16f)](_0x25359a,_0x2b088c[0x0][_0x439e99(0x15e)]))return _0x119d5c[_0x439e99(0x170)](0x191)[_0x439e99(0x158)]({'error':'Unauthorized'});const {id:_0x4bedea}=_0x2b088c[0x0];return _0x119d5c['json']({'user':_0x2b088c[0x0],'token':jsonwebtoken_1['default'][_0x439e99(0x157)]({'id':_0x4bedea},auth_1[_0x439e99(0x162)][_0x439e99(0x164)],{'expiresIn':auth_1['default']['expiresIn']}),'expires_in':auth_1[_0x439e99(0x162)][_0x439e99(0x15d)]});}}exports[_0x1ab706(0x162)]=SessionController;